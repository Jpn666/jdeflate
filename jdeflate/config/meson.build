# major, minor and patch
versionarray = [0, 0, 0]

mmp = meson.project_version().split('.')
if mmp.length() == 3
  versionarray = [
    mmp[0].to_int(),
    mmp[1].to_int(),
    mmp[2].to_int()
  ]
endif


# Configuration
conf = configuration_data()

# build the version string
v0 = versionarray[0]
v1 = versionarray[1]
v2 = versionarray[2]
version = f'@v0@.@v1@.@v2@'


conf.set('version', version)

conf.set('version_major', v0)
conf.set('version_minor', v1)
conf.set('version_patch', v2)


if meson.is_subproject()
  configure_file(input: 'config.h.in', output: 'config.h', configuration: conf)
else
  configure_file(input: 'config.h.in', output: 'config.h', configuration: conf, install: true, install_dir: 'include/jdeflate/config')
endif